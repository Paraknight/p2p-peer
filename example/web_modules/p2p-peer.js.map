{"version":3,"file":"p2p-peer.js","sources":["../../pkg/dist-web/index.js"],"sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\n// TODO: Use three.js' built-in implementation instead?\nclass EventEmitter {\n  constructor() {\n    this.listeners = {};\n  }\n\n  on(event, callback) {\n    this.listeners[event] = this.listeners[event] || [];\n    this.listeners[event].push(callback);\n  }\n\n  removeListener(event, callback) {\n    this.listeners[event] = this.listeners[event] || [];\n    let id = this.listeners[event].indexOf(callback);\n    if (id < 0) return;\n    this.listeners[event].splice(id, 1);\n  }\n\n  emit(event) {\n    this.listeners[event] = this.listeners[event] || [];\n\n    for (var _len = arguments.length, data = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      data[_key - 1] = arguments[_key];\n    }\n\n    for (let callback of this.listeners[event]) callback(...data);\n  }\n\n}\n\nclass Peer extends EventEmitter {\n  constructor(uid, network) {\n    super();\n    this.uid = uid;\n    this.network = network;\n    this.rooms = [];\n    this.conn = new RTCPeerConnection();\n\n    this.conn.onicecandidate = event => event.candidate && this.network.signal('ice', {\n      to: this.uid,\n      candidate: event.candidate\n    });\n\n    this.conn.ondatachannel = event => this.ondatachannel(event.channel);\n  }\n\n  createOffer() {\n    this.conn.createOffer().then(offer => this.conn.setLocalDescription(offer)).then(() => this.network.signal('sdp', {\n      to: this.uid,\n      sdp: this.conn.localDescription\n    })).catch(error => console.error('Error creating connection offer:', error));\n  }\n\n  createAnswer(sdp) {\n    this.conn.createAnswer().then(answer => this.conn.setLocalDescription(answer)).then(() => this.network.signal('sdp', {\n      to: this.uid,\n      sdp: this.conn.localDescription\n    })).catch(error => console.error('Error creating connection answer:', error));\n  } // TODO: Support reliable and unreliable\n\n\n  createDataChannel(label) {\n    this.dataChannel = this.conn.createDataChannel(label);\n    this.ondatachannel(this.dataChannel);\n  }\n\n  ondatachannel(channel) {\n    this.dataChannel = channel;\n\n    channel.onerror = error => console.error('Peer', this.uid, 'DataChannel error:', error);\n\n    channel.onopen = () => this.emit('datachannelopen', this);\n\n    channel.onclose = () => this.emit('datachannelclose', this);\n\n    channel.onmessage = event => this.onmessage(event.data);\n  }\n\n  onmessage(message) {\n    try {\n      message = JSON.parse(message);\n    } catch (e) {\n      console.error('Invalid data received from', this.uid, ':', message, e);\n      return;\n    }\n\n    this.emit('message', message); // TODO: Validate this too\n\n    this.emit(message.event, message.data);\n  }\n\n  send(event, data) {\n    if (this.dataChannel == null || this.dataChannel.readyState !== 'open') return;\n    this.dataChannel.send(JSON.stringify({\n      event,\n      data\n    }));\n  }\n\n  disconnect() {\n    if (!(this.uid in this.network.peers)) return;\n    this.rooms = [];\n    delete this.network.peers[this.uid];\n    if (this.dataChannel != null) this.dataChannel.close();\n    if (this.conn.signalingState !== 'closed') this.conn.close(); // TODO: Reconnect if wrongful DC\n\n    this.emit('disconnect');\n  }\n\n}\n\nclass PeerNetwork extends EventEmitter {\n  constructor() {\n    super();\n    this.ownUID = null;\n    this.peers = {};\n  }\n\n  signal(event) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    this.sigServ.emit(event, ...args);\n    return this;\n  }\n\n  join(roomID) {\n    console.log('Joining room', roomID);\n    this.sigServ.emit('join', {\n      rid: roomID\n    });\n    return this;\n  }\n\n  leave(roomID) {\n    console.log('Leaving room', roomID);\n    this.sigServ.emit('leave', {\n      rid: roomID\n    });\n    return this;\n  }\n\n  broadcast(event, data) {\n    for (let uid in this.peers) this.peers[uid].send(event, data);\n  }\n\n  connect(sigServURL) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      sigServURL = new URL(sigServURL); // TODO: Catch error\n\n      yield new Promise((resolve, reject) => {\n        let script = document.createElement('script');\n        script.type = 'text/javascript';\n        sigServURL.pathname = '/socket.io/socket.io.js';\n        script.src = sigServURL.href;\n        script.addEventListener('load', resolve, false);\n        script.addEventListener('error', reject, false);\n        document.body.appendChild(script);\n      });\n      _this.sigServ = io(sigServURL.origin);\n\n      _this.sigServ.on('connect', () => {//console.log('Peer connected to signalling server');\n      });\n\n      _this.sigServ.on('disconnect', () => {//console.log('Peer disconnected from signalling server');\n      });\n\n      _this.sigServ.on('uid', uid => {\n        //console.log('Peer UID is', uid);\n        _this.ownUID = uid;\n\n        _this.emit('uid', uid);\n      });\n\n      _this.sigServ.on('join', data => {\n        //console.log('A peer with UID', data.uid, 'just joined the room', data.rid);\n        if (!(data.uid in _this.peers)) {\n          let peer = new Peer(data.uid, _this);\n          peer.rooms.push(data.rid);\n          peer.on('datachannelopen', peer => _this.emit('connection', peer));\n          peer.on('datachannelclose', peer => peer.disconnect());\n          peer.on('disconnect', () => _this.emit('disconnection', peer));\n          _this.peers[data.uid] = peer;\n        }\n\n        _this.sigServ.emit('hail', {\n          to: data.uid,\n          rid: data.rid\n        });\n      });\n\n      _this.sigServ.on('hail', data => {\n        //console.log('A peer with UID', data.from, 'just hailed from', data.rid);\n        if (data.from in _this.peers) {\n          _this.peers[data.from].rooms.push(data.rid);\n\n          return;\n        }\n\n        let peer = new Peer(data.from, _this);\n        peer.rooms.push(data.rid);\n        peer.on('datachannelopen', peer => _this.emit('connection', peer));\n        peer.on('datachannelclose', peer => peer.disconnect());\n        peer.on('disconnect', () => _this.emit('disconnection', peer));\n        peer.createDataChannel(_this.ownUID + '_' + data.from);\n        peer.createOffer();\n        _this.peers[data.from] = peer;\n      });\n\n      _this.sigServ.on('sdp', data => {\n        let sdp = data.sdp; //console.log('SDP', sdp.type, 'received from peer with UID', data.from);\n\n        if (_this.peers[data.from] == null) return;\n\n        _this.peers[data.from].conn.setRemoteDescription(new RTCSessionDescription(sdp));\n\n        if (sdp.type === 'offer') _this.peers[data.from].createAnswer(sdp);\n      });\n\n      _this.sigServ.on('ice', data => {\n        //console.log('ICE data received from peer with UID', data.from);\n        if (_this.peers[data.from] == null) return;\n\n        _this.peers[data.from].conn.addIceCandidate(new RTCIceCandidate(data.candidate));\n      });\n\n      _this.sigServ.on('leave', data => {\n        if (!(data.uid in _this.peers)) return;\n        let peer = _this.peers[data.uid];\n\n        if (data.rid == null) {\n          //console.log('A peer with UID', data.uid, 'just left all rooms');\n          peer.disconnect();\n          return;\n        }\n\n        if (!(data.rid in peer.rooms)) return; //console.log('A peer with UID', data.uid, 'just left the room', data.rid);\n\n        peer.rooms.splice(peer.rooms.indexOf(data.rid), 1);\n        if (peer.rooms.length > 0) return;\n        peer.disconnect();\n      });\n\n      return _this;\n    })();\n  }\n\n}\n\nexport default PeerNetwork;\n"],"names":[],"mappings":"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"}