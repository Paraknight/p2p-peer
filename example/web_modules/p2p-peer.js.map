{"version":3,"file":"p2p-peer.js","sources":["../../pkg/dist-web/index.js"],"sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nconst iceServers = [{\n  url: 'stun:stun.l.google.com:19302'\n}, {\n  url: 'stun:stun1.l.google.com:19302'\n}, {\n  url: 'stun:stun2.l.google.com:19302'\n}, {\n  url: 'stun:stun3.l.google.com:19302'\n}, {\n  url: 'stun:stun4.l.google.com:19302'\n}, {\n  url: 'stun:stun.services.mozilla.com'\n}, {\n  url: 'stun:23.21.150.121'\n}, {\n  url: 'stun:stun.anyfirewall.com:3478'\n}, {\n  url: 'stun:stun01.sipphone.com'\n}, {\n  url: 'stun:stun.ekiga.net'\n}, {\n  url: 'stun:stun.fwdnet.net'\n}, {\n  url: 'stun:stun.ideasip.com'\n}, {\n  url: 'stun:stun.iptel.org'\n}, {\n  url: 'stun:stun.rixtelecom.se'\n}, {\n  url: 'stun:stun.schlund.de'\n}, {\n  url: 'stun:stunserver.org'\n}, {\n  url: 'stun:stun.softjoys.com'\n}, {\n  url: 'stun:stun.voiparound.com'\n}, {\n  url: 'stun:stun.voipbuster.com'\n}, {\n  url: 'stun:stun.voipstunt.com'\n}, {\n  url: 'stun:stun.voxgratia.org'\n}, {\n  url: 'stun:stun.xten.com'\n}, {\n  url: 'turn:turn.bistri.com:80',\n  credential: 'homeo',\n  username: 'homeo'\n}, {\n  url: 'turn:turn.anyfirewall.com:443?transport=tcp',\n  credential: 'webrtc',\n  username: 'webrtc'\n}, {\n  url: 'turn:numb.viagenie.ca',\n  credential: 'muazkh',\n  username: 'webrtc@live.com'\n}, {\n  url: 'turn:192.158.29.39:3478?transport=udp',\n  credential: 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',\n  username: '28224511:1379330808'\n}, {\n  url: 'turn:192.158.29.39:3478?transport=tcp',\n  credential: 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',\n  username: '28224511:1379330808'\n}];\n\nclass Peer extends EventTarget {\n  constructor(uid, network) {\n    super();\n    var self = this;\n    this.uid = uid;\n    this.network = network;\n    this.rooms = [];\n    let conn = this.conn = new RTCPeerConnection({\n      iceServers: iceServers\n    });\n\n    conn.onicecandidate = event => {\n      if (event.candidate != null) {\n        self.network.signal('ice', {\n          candidate: event.candidate,\n          to: self.uid\n        });\n      }\n    };\n\n    conn.ondatachannel = event => {\n      self.ondatachannel(event.channel);\n    };\n  }\n\n  createOffer() {\n    var self = this;\n    this.conn.createOffer(sdp => {\n      self.conn.setLocalDescription(sdp);\n      self.network.signal('sdp', {\n        sdp: sdp,\n        to: self.uid\n      });\n    }, () => {});\n  }\n\n  createAnswer(sdp) {\n    var self = this;\n    this.conn.createAnswer(sdp => {\n      self.conn.setLocalDescription(sdp);\n      self.network.signal('sdp', {\n        sdp: sdp,\n        to: self.uid\n      });\n    }, () => {});\n  }\n\n  createDataChannel(label) {\n    var self = this;\n    let dataChannel = this.dataChannel = this.conn.createDataChannel(label);\n\n    dataChannel.onerror = error => console.error(\"Peer \" + self.uid + \" DataChannel Error:\", error);\n\n    dataChannel.onopen = () => self.dispatchEvent(new Event('datachannelopen'));\n\n    dataChannel.onclose = () => self.dispatchEvent(new Event('datachannelclose'));\n\n    dataChannel.onmessage = event => self.onmessage(JSON.parse(event.data));\n\n    return dataChannel;\n  }\n\n  ondatachannel(channel) {\n    var self = this;\n    let dataChannel = this.dataChannel = channel;\n\n    dataChannel.onerror = error => console.error(\"Peer \" + self.uid + \" DataChannel Error:\", error);\n\n    dataChannel.onopen = () => self.dispatchEvent(new Event('datachannelopen'));\n\n    dataChannel.onclose = () => self.dispatchEvent(new Event('datachannelclose'));\n\n    dataChannel.onmessage = event => self.onmessage(JSON.parse(event.data));\n  }\n\n  onmessage(message) {\n    this.dispatchEvent(new CustomEvent('message', {\n      detail: message\n    }));\n    this.dispatchEvent(new CustomEvent(message.event, {\n      detail: message.data\n    }));\n  }\n\n  send(event, data) {\n    if (this.dataChannel == null) return;\n    this.dataChannel.send(JSON.stringify({\n      event: event,\n      data: data\n    }));\n  }\n\n  disconnect() {\n    if (!(this.uid in this.network.peers)) return;\n    this.rooms = [];\n    delete this.network.peers[this.uid];\n    if (this.dataChannel != null) this.dataChannel.close();\n    if (this.conn.signalingState !== 'closed') this.conn.close();\n    this.dispatchEvent(new Event('disconnect'));\n  }\n\n}\n\nclass PeerNetwork extends EventTarget {\n  constructor() {\n    super();\n  }\n\n  connect(sigServUrl) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      var self = _this;\n      sigServUrl = new URL(sigServUrl);\n      _this.ownUid = null;\n      _this.peers = {}; // TODO: Catch error\n\n      yield new Promise((resolve, reject) => {\n        let script = document.createElement('script');\n        script.type = 'text/javascript';\n        sigServUrl.pathname = '/socket.io/socket.io.js';\n        script.src = sigServUrl.href;\n        script.addEventListener('load', resolve, false);\n        script.addEventListener('error', reject, false);\n        document.body.appendChild(script);\n      });\n      let sigServ = _this.sigServ = io(sigServUrl.origin);\n      sigServ.on('connect', () => {});\n      sigServ.on('uid', uid => {\n        self.ownUid = uid;\n\n        _this.dispatchEvent(new CustomEvent('uid', {\n          detail: uid\n        }));\n      });\n      sigServ.on('join', data => {\n        if (!(data.uid in self.peers)) {\n          let peer = self.peers[data.uid] = new Peer(data.uid, self);\n          peer.rooms.push(data.rid);\n          peer.addEventListener('datachannelopen', event => self.dispatchEvent(new CustomEvent('connection', {\n            detail: peer\n          })));\n          peer.addEventListener('datachannelclose', event => peer.disconnect());\n        }\n\n        sigServ.emit('hail', {\n          to: data.uid,\n          rid: data.rid\n        });\n      });\n      sigServ.on('hail', data => {\n        if (!(data.from in self.peers)) {\n          let peer = self.peers[data.from] = new Peer(data.from, self);\n          peer.rooms.push(data.rid);\n          peer.addEventListener('datachannelopen', event => self.dispatchEvent(new CustomEvent('connection', {\n            detail: peer\n          })));\n          peer.addEventListener('datachannelclose', event => peer.disconnect());\n          peer.createDataChannel(self.ownUid + \"_\" + data.from);\n          peer.createOffer();\n        } else {\n          self.peers[data.from].rooms.push(data.rid);\n        }\n      });\n      sigServ.on('sdp', data => {\n        var sdp = data.sdp;\n        var peer;\n        if ((peer = self.peers[data.from]) != null) peer.conn.setRemoteDescription(new RTCSessionDescription(sdp));\n        if (sdp.type === 'offer') peer.createAnswer(sdp);\n      });\n      sigServ.on('ice', data => {\n        var peer;\n        if ((peer = self.peers[data.from]) != null) peer.conn.addIceCandidate(new RTCIceCandidate(data.candidate));\n      });\n      sigServ.on('leave', data => {\n        if (!(data.uid in self.peers)) return;\n        var peer = self.peers[data.uid];\n\n        if (data.rid == null) {\n          peer.disconnect();\n          return;\n        }\n\n        if (!(data.rid in peer.rooms)) return;\n        peer.rooms.splice(peer.rooms.indexOf(data.rid), 1);\n        if (!(peer.rooms.length < 1)) return;\n        peer.disconnect();\n      });\n      sigServ.on('disconnect', () => {});\n    })();\n  }\n\n  signal(event, data) {\n    this.sigServ.emit(event, data);\n  }\n\n  join(roomId) {\n    this.sigServ.emit('join', {\n      rid: roomId\n    });\n  }\n\n  leave(roomId) {\n    this.sigServ.emit('leave', {\n      rid: roomId\n    });\n  }\n\n}\n\nexport default PeerNetwork;\n"],"names":[],"mappings":"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"}